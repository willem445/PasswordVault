using PasswordVault.Services;
using PasswordVault.Models;

/*=================================================================================================
DESCRIPTION
*================================================================================================*/
/* 
 ------------------------------------------------------------------------------------------------*/

namespace PasswordVault.Desktop.Winforms
{
    /*=================================================================================================
	ENUMERATIONS
	*================================================================================================*/

    /*=================================================================================================
	STRUCTS
	*================================================================================================*/

    /*=================================================================================================
	CLASSES
	*================================================================================================*/
    class EditUserPresenter
    {
        /*=================================================================================================
		CONSTANTS
		*================================================================================================*/
        /*PUBLIC******************************************************************************************/

        /*PRIVATE*****************************************************************************************/

        /*=================================================================================================
		FIELDS
		*================================================================================================*/
        /*PUBLIC******************************************************************************************/

        /*PRIVATE*****************************************************************************************/
        private IEditUserView _editUserView;
        private IDesktopServiceWrapper _serviceWrapper;

        /*=================================================================================================
		PROPERTIES
		*================================================================================================*/
        /*PUBLIC******************************************************************************************/

        /*PRIVATE*****************************************************************************************/

        /*=================================================================================================
		CONSTRUCTORS
		*================================================================================================*/
        public EditUserPresenter(IEditUserView editUserView, IDesktopServiceWrapper serviceWrapper)
        {
            _editUserView = editUserView;
            _serviceWrapper = serviceWrapper;

            _editUserView.ModifyAccountEvent += ModifyUserInformation;
            _editUserView.RequestUserEvent += GetUserInformation;
        }

        /*=================================================================================================
		PUBLIC METHODS
		*================================================================================================*/
        /*************************************************************************************************/

        /*=================================================================================================
		PRIVATE METHODS
		*================================================================================================*/
        /*************************************************************************************************/
        private void ModifyUserInformation(string firstName, string lastName, string email, string phoneNumber)
        {
            User user = new User(null, null, firstName, lastName, phoneNumber, email);
            UserInformationResult result = _serviceWrapper.EditUser(user);
            _editUserView.DisplayModifyResult(result);
        }

        /*************************************************************************************************/
        private void GetUserInformation()
        {
            User user = _serviceWrapper.GetCurrentUser();
            _editUserView.DisplayUser(user);
        }

        /*=================================================================================================
		STATIC METHODS
		*================================================================================================*/
        /*************************************************************************************************/

    } // EditUserPresenter CLASS
} // PasswordVault NAMESPACE
